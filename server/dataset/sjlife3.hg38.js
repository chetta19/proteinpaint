/* when using snplocus term in regression analysis, restrict to an ancestry
each correspond to a tvs to be added for filtering samples
and the set of pc values to be used as co-variates
*/
const restrictAncestries = [
	{
		name: 'European ancestry',
		tvs: {
			term: {
				id: 'genetic_race',
				type: 'categorical',
				name: 'Genetically defined race'
			},
			values: [{ key: 'European Ancestry', label: 'European Ancestry' }]
		},
		// principal components as covariates in a model using genetic markers
		// 10 PCs for each sample, as 10 columns in each file
		PCcount: 10,
		PCfileBySubcohort: {
			SJLIFE: {
				file: 'files/hg38/sjlife/clinical/PCA/european.sjlife'
				// once loaded, pcs Map is attached here for each subcohort combination
			},
			CCSS: { file: 'files/hg38/sjlife/clinical/PCA/european.ccss' },
			'CCSS,SJLIFE': { file: 'files/hg38/sjlife/clinical/PCA/european.sjlife.ccss' }
		}
	},
	{
		name: 'African ancestry',
		tvs: {
			term: {
				id: 'genetic_race',
				type: 'categorical',
				name: 'Genetically defined race'
			},
			values: [{ key: 'African Ancestry', label: 'African Ancestry' }]
		},
		PCcount: 10,
		// a single pc file, not divided into subcohorts
		PCfile: 'files/hg38/sjlife/clinical/PCA/african.sjlife.ccss'
		// pcs Map is attached here
	}
]

module.exports = {
	isMds3: true,

	/* still only a quick fix
	sample2bam: {
		SJL5088613: 'files/hg38/sjlife/wgs-bam/SJST041646_G1.bam'
	},
	*/

	cohort: {
		allowedChartTypes: ['summary', 'cuminc', 'survival', 'regression'],

		db: {
			file: 'files/hg38/sjlife/clinical/db'
		},

		termdb: {
			allowedTermTypes: [
				'snplst' // as independent variable in mass regression
				// to add 'snplocus' 'prs' later
			],

			minTimeSinceDx: 5, // minimum number of years since cancer diagnosis for enrollment in the SJLIFE study

			coxTimeMsg: 'years since entry into the cohort',

			coxStartTimeMsg: `begins at 5 years post cancer diagnosis`,

			// term ids specific to dataset
			termIds: {
				ageDxId: 'agedx', // age at diagnosis
				ageLastVisitId: 'agelastvisit', // age at last visit
				ageNdiId: 'a_ndi', // age at last NDI seach
				ageDeathId: 'a_death' // age at death
			},

			ageEndOffset: 0.00274, // number of years to offset ending age of patients
			// for cox outcome with timeScale='age'
			// 1 day (i.e. 1/365 or 0.00274) needs to be added
			// to age_end to prevent age_end = age_start (which
			// would cause regression analysis to fail in R)

			restrictAncestries,

			//// this attribute is optional

			//// this attribute is optional
			selectCohort: {
				// wrap term.id into a term json object so as to use it in tvs;
				// the term is not required to exist in termdb
				// term.id is specific to this dataset, should not use literally in client/server code but always through a variable
				term: {
					id: 'subcohort',
					type: 'categorical'
				},
				title: 'Welcome to the St. Jude Survivorship Portal',
				description: `The St. Jude Survivorship Portal is a data portal for exploring, analyzing, and sharing data from survivors of pediatric cancer. The portal hosts a wide range of data types collected from cancer survivors, including demographic, genetic, cancer treatment, clinical outcome, and patient-reported data. These datasets were generated by two large-scale longitudinal studies of pediatric cancer survivors: the <a href='https://sjlife.stjude.org/' target='_blank'>St. Jude Lifetime Cohort Study (SJLIFE)</a> and the <a href='https://ccss.stjude.org/' target='_blank'>Childhood Cancer Survivor Study (CCSS)</a>. Users may select one or both of these cohorts to analyze on the portal. The data of each cohort is organized hierarchically in a data dictionary that can be explored by the user. This data can be summarized and visualized using bar charts or analyzed using statistical analyses, such as cumulative incidence analyses and regression analyses. The raw data of each cohort may also be downloaded by the user for further use.`,
				prompt: `To get started, select a survivor cohort to analyze in the portal. Once a cohort is selected, click on the "CHARTS" tab at the top to explore and analyze the data of this cohort.`,
				values: [
					// <ul><li> for items, with a radio button for each.
					{
						keys: ['SJLIFE'],
						label: 'St. Jude Lifetime Cohort (SJLIFE)',
						shortLabel: 'SJLIFE',
						isdefault: true,
						cssSelector: 'tbody > tr > td:nth-child(2)'
					},
					{
						keys: ['CCSS'],
						label: 'Childhood Cancer Survivor Study (CCSS)',
						shortLabel: 'CCSS',
						cssSelector: 'tbody > tr > td:nth-child(3)'
					},
					{
						keys: ['SJLIFE', 'CCSS'],
						label: 'Combined SJLIFE+CCSS*',
						shortLabel: 'SJLIFE+CCSS',
						cssSelector: 'tbody > tr > td:nth-child(2), tbody > tr > td:nth-child(3)'
					}
				],
				asterisk:
					'*The combined cohort is limited to those variables that are comparable between SJLIFE and CCSS. For example, clinical assessment variables are not available for the combined cohort because they are only available for the SJLIFE cohort.',
				highlightCohortBy: 'cssSelector'
			},

			dataDownloadCatch: {
				helpLink: 'https://university.stjude.cloud/docs/visualization-community/data-download/',
				missingAccess: {
					message:
						"You are missing approval to one or more of the required datasets. Please go to <a target=_blank href='MISSING-ACCESS-LINK'>Genomics Platform Data Browser</a> to request access. For more information, please see this <a target=_blank href='https://university.stjude.cloud/docs/visualization-community/data-download/'>tutorial.</a>",
					links: {
						sjlife: 'https://platform.stjude.cloud/data/cohorts?selected_tags=SJC-DS-1002',
						ccss: 'https://platform.stjude.cloud/data/cohorts?selected_tags=SJC-DS-1005',
						'sjlife,ccss': 'https://platform.stjude.cloud/data/cohorts?selected_tags=SJC-DS-1002,SJC-DS-1005'
					}
				},
				jwt: {
					'Invalid token': 'https://university.stjude.cloud/docs/visualization-community/data-download/'
				}
			},

			helpPages: [
				// to use for help button in MASS UI
				// array of url links to help pages
				// if undefined, then help button will not appear
				{
					label: 'Tutorial',
					url: 'https://docs.google.com/document/d/1zofA9oRZMAOHb8WBPKWePMHLgyVeDuHXtadoTf_msRA/edit?usp=sharing'
				},
				{
					label: 'Questions/comments',
					url: 'https://groups.google.com/g/proteinpaint'
				}
			]
		}
	}
}
