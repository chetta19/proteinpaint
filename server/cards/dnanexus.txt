<div style="line-height: 1.5em;">
    <h1 style="text-align: center; margin-top: 8%;">
       Launch ProteinPaint with DNAnexus FileViewer
    </h1>
    <br>
    <p style="font-style:oblique; font-weight: 300; margin: 0vw 5vw; text-align:center; color: #403f3f;">
       DNAnexus provides a secure way to view unpublished/sensitive files as custom ProteinPaint tracks. The ProteinPaint FileViewer launches VCF, BigWig, JSON BED, Splice Junction, and BAM tracks. 
    </p>
    <br>
    <div style="margin:0vw 2vw; display: flex; justify-content: center; padding: 10px;">
        <button type="button" onclick="window.open('https://pecan.stjude.cloud/static/fileviewers/ProteinPaint%20(VCF,%20bigWig,%20BEDj,%20junction,%20BAM).gz','_self', 'download')" style="background-color: #d0e3ff; padding: 8px; border-radius: 3px; border: none; display: inline-block;margin: 0px 10px; font-size: 1.1em;">Download ProteinPaint FileViewer</button>
    </div>
    <div style="margin: 3vw;">
         <p style="margin-left: 2vw;">
            This tutorial is specific to ProteinPaint. For more detailed information about DNAnexus, please see the <a href="https://documentation.dnanexus.com/" target="_blank"> documentation</a>.
        </p>
        <br>
        <h2 style="font-size: 1.2em;">
            Getting Started
        </h2>
        <p style="margin-left: 2vw;">
            <ul style="margin-left: 2vw;">
                <li>
                    Create an account with DNAnexus. <a href="https://university.stjude.cloud/docs/genomics-platform/accounts-and-billing/" target="_blank">Follow the instructions from St. Jude Cloud</a>. Please direct questions regarding account set up to the St. Jude Cloud team <a href="mailto:support@stjude.cloud?subject=Help Setting Up a DNAnexus Account">support@stjude.cloud</a>).
                </li>
                <li>
                    Create a token from the <a href="https://platform.dnanexus.com/" target="_self">DNAnexus platform</a>. See this link on how to generate an authentication <a href="https://documentation.dnanexus.com/user/login-and-logout#authentication-tokens" target="_blank">token</a>. Be sure to save the token!
                </li>
                <li>
                    Create a new project in DNAnexus with Azure (will not work with AWS funded projects). See the DNAnexus documentation <a href="https://documentation.dnanexus.com/getting-started/ui-quickstart#step-1-make-your-first-project target="_blank">See the DNAnexus documentation</a> for instructions on how to set up a new project.
                </li>
                <li>
                    Download the ProteinPaint FileViewer from the blue button above. 
                </li>
                <li>
                    Install dx-toolkit by following the <a href="https://documentation.dnanexus.com/downloads" target="_blank">DNAnexus documentation</a>.
                </li>
            </ul>
        <br>
        </p>
        <p style="margin-left: 2vw;">
        Tip: Uploading files from the command line is faster than from the web browser. Instructions for both methods are provided.
        </p>
        <h2 style="font-size: 1.2em;">
            Prepare Files
        </h2>
        <p style="margin-left: 2vw;">
            Ensure all files end with one of the following extensions: 
            <ul style="margin-left: 2vw; opacity:0.65;">
                <li>
                    .vcf.gz
                </li>
                <li>
                    .bw
                </li>                
                <li>
                    .bedj.gz
                </li>
                <li>
                    .bam
                </li>
            </ul>
        </p>
        <p style="margin-left: 2vw;">
            Index files for VCF, bedj, and BAM are required.
            <br><br>
            Create the index file for the VCF, bedj and BAM files with the following commands. These commands require samtools, bcftools, and htslib packages. Download these packages <a href="http://www.htslib.org/download/" target="_blank">here</a>.
            <br><br>
            Index a VCF or bedj file with these commands:
        <pre style="opacity:0.65;">
        $ sort -k1,1 -k2,2n FILE > FILE.sorted
        $ bgzip FILE.sorted
        $ tabix -p bed FILE.sorted.gz
        </pre>
        </p>
        <p style="margin-left: 2vw;">
            Index a BAM file with the following command:
        <pre style="opacity:0.65;"> 
        $ samtools index bamFile.bam 
        </pre>
        </p>
        <h2 style="font-size: 1.2em;">
            Upload: Command Line
        </h2>
        <p style="margin-left: 2vw;">
            All DNAnexus dx-toolkit commands begin with dx. A full list of commands to navigate through folders, copy files, etc. is available <a href="https://documentation.dnanexus.com/user/helpstrings-of-sdk-command-line-utilities" target="_blank">here</a>.
            <br>
            Login into DNAnexus with your authentication token:
        <pre style="opacity:0.65;">
        $ dx login --token MyAuthenicationToken
        </pre>
        </p>
        <p style="margin-left: 2vw;">
            A list of available projects will appear. Select the appropriate project from the number appearing in brackets:
            <pre style="opacity:0.65;">
            Available projects (CONTRIBUTE or higher):
            [0]My_ProteinPaint_Project

            Pick a numbered choice: 0
            </pre>
        </p>
        <h2 style="font-size: 1.2em;">
            Upload: DNAnexus Website
        </h2>
        <p style="margin-left: 2vw;">
            Uploading files through the DNAnexus website is easy but takes more time and processing power.
            <ul style="margin-left: 2vw;">
                <li>
                    Select the appropriate project
                </li>
                <li>
                    Click the Upload button. Upload all files and the FileViewer. 
                </li>
            </ul>
        </p>
        <h2 style="font-size: 1.2em;">
            Launch FileViewer
        </h2>
        <p style="margin-left: 2vw;">
            Open the DNAnexus website and navigate to the project.
             <ul style="margin-left: 2vw;">
                <li>
                    Click on the ProteinPaint (VCF, bigWig, BEDj, junction, BAM) FileViewer.
                </li>
                <li>
                    Select which files to visualize in ProteinPaint. Ensure to include index files.
                    <img style="width: 60vw; margin: 0vw 2vw;" src="https://pecan.stjude.cloud/static/proteinpaint_demo/fileviewers/select_files.png">
                </li>
                <li>
                    Click Launch Viewer in the bottom right of the window.
                </li>
            </ul>
        </p>
        <p style="margin-left: 2vw;">
            The following interface will appear in the browser. 
            <img style="width: 60vw; margin: 0vw 2vw;" src="https://pecan.stjude.cloud/static/proteinpaint_demo/fileviewers/interface.png">
            Select the reference genome. Then, enter a genomic position or search for a gene to launch the visualization. ProteinPaint will launch in a new tab.
            <img style="width: 60vw; margin: 0vw 2vw;" src="https://pecan.stjude.cloud/static/proteinpaint_demo/fileviewers/final.png">
            The URL created from the FileViewer is only available while the tab is open. Once the tab is closed, repeat the steps in this section to launch the FileViewer again.
        </p>
    </div>
</div>